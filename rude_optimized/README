Optimized version of rude (minimize memory allocation and speed up the code)
